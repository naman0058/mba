{"ast":null,"code":"// ./src/azure-storage-blob.ts\n// <snippet_package>\n// THIS IS SAMPLE CODE ONLY - NOT MEANT FOR PRODUCTION USE\nimport { BlobServiceClient } from \"@azure/storage-blob\";\nconst containerName = `uploaded`;\nconst sasToken = process.env.REACT_APP_AZURE_STORAGE_SAS_TOKEN;\nconst storageAccountName = process.env.REACT_APP_AZURE_STORAGE_RESOURCE_NAME; // </snippet_package>\n// <snippet_get_client>\n\nconst uploadUrl = `https://${storageAccountName}.blob.core.windows.net/?${sasToken}`;\nconsole.log(uploadUrl); // get BlobService = notice `?` is pulled out of sasToken - if created in Azure portal\n\nconst blobService = new BlobServiceClient(uploadUrl); // get Container - full public read access\n\nconst containerClient = blobService.getContainerClient(containerName); // </snippet_get_client>\n// <snippet_isStorageConfigured>\n// Feature flag - disable storage feature to app if not configured\n\nexport const isStorageConfigured = () => {\n  return !storageAccountName || !sasToken ? false : true;\n}; // </snippet_isStorageConfigured>\n// <snippet_getBlobsInContainer>\n// return list of blobs in container to display\n\nexport const getBlobsInContainer = async () => {\n  const returnedBlobUrls = []; // get list of blobs in container\n  // eslint-disable-next-line\n\n  for await (const blob of containerClient.listBlobsFlat()) {\n    console.log(`${blob.name}`);\n    const blobItem = {\n      url: `https://${storageAccountName}.blob.core.windows.net/${containerName}/${blob.name}?${sasToken}`,\n      name: blob.name\n    }; // if image is public, just construct URL\n\n    returnedBlobUrls.push(blobItem);\n  }\n\n  return returnedBlobUrls;\n}; // </snippet_getBlobsInContainer>\n// <snippet_createBlobInContainer>\n\nconst createBlobInContainer = async file => {\n  // create blobClient for container\n  const blobClient = containerClient.getBlockBlobClient(file.name); // set mimetype as determined from browser with file upload control\n\n  const options = {\n    blobHTTPHeaders: {\n      blobContentType: file.type\n    }\n  }; // upload file\n\n  await blobClient.uploadData(file, options);\n}; // </snippet_createBlobInContainer>\n// <snippet_uploadFileToBlob>\n\n\nconst uploadFileToBlob = async file => {\n  if (!file) return; // upload file\n\n  await createBlobInContainer(file);\n}; // </snippet_uploadFileToBlob>\n\n\nexport default uploadFileToBlob;","map":{"version":3,"sources":["D:/naman-cloud9/naman-cloud9/src/pages/azure-storage-blob.js"],"names":["BlobServiceClient","containerName","sasToken","process","env","REACT_APP_AZURE_STORAGE_SAS_TOKEN","storageAccountName","REACT_APP_AZURE_STORAGE_RESOURCE_NAME","uploadUrl","console","log","blobService","containerClient","getContainerClient","isStorageConfigured","getBlobsInContainer","returnedBlobUrls","blob","listBlobsFlat","name","blobItem","url","push","createBlobInContainer","file","blobClient","getBlockBlobClient","options","blobHTTPHeaders","blobContentType","type","uploadData","uploadFileToBlob"],"mappings":"AAAA;AAEA;AACA;AACA,SAASA,iBAAT,QAAkC,qBAAlC;AAEA,MAAMC,aAAa,GAAI,UAAvB;AACA,MAAMC,QAAQ,GAAGC,OAAO,CAACC,GAAR,CAAYC,iCAA7B;AACA,MAAMC,kBAAkB,GAAGH,OAAO,CAACC,GAAR,CAAYG,qCAAvC,C,CACA;AAEA;;AACA,MAAMC,SAAS,GAAI,WAAUF,kBAAmB,2BAA0BJ,QAAS,EAAnF;AACAO,OAAO,CAACC,GAAR,CAAYF,SAAZ,E,CAEA;;AACA,MAAMG,WAAW,GAAG,IAAIX,iBAAJ,CAAsBQ,SAAtB,CAApB,C,CAEA;;AACA,MAAMI,eAAe,GACnBD,WAAW,CAACE,kBAAZ,CAA+BZ,aAA/B,CADF,C,CAEA;AAEA;AACA;;AACA,OAAO,MAAMa,mBAAmB,GAAG,MAAM;AACvC,SAAO,CAACR,kBAAD,IAAuB,CAACJ,QAAxB,GAAmC,KAAnC,GAA2C,IAAlD;AACD,CAFM,C,CAGP;AAEA;AACA;;AACA,OAAO,MAAMa,mBAAmB,GAAG,YAAY;AAC7C,QAAMC,gBAAgB,GAAG,EAAzB,CAD6C,CAG7C;AACA;;AACA,aAAW,MAAMC,IAAjB,IAAyBL,eAAe,CAACM,aAAhB,EAAzB,EAA0D;AACxDT,IAAAA,OAAO,CAACC,GAAR,CAAa,GAAEO,IAAI,CAACE,IAAK,EAAzB;AAEA,UAAMC,QAAQ,GAAG;AACfC,MAAAA,GAAG,EAAG,WAAUf,kBAAmB,0BAAyBL,aAAc,IAAGgB,IAAI,CAACE,IAAK,IAAGjB,QAAS,EADpF;AAEfiB,MAAAA,IAAI,EAAEF,IAAI,CAACE;AAFI,KAAjB,CAHwD,CAQxD;;AACAH,IAAAA,gBAAgB,CAACM,IAAjB,CAAsBF,QAAtB;AACD;;AAED,SAAOJ,gBAAP;AACD,CAlBM,C,CAmBP;AAUA;;AACA,MAAMO,qBAAqB,GAAG,MAAOC,IAAP,IAAgB;AAC5C;AACA,QAAMC,UAAU,GAAGb,eAAe,CAACc,kBAAhB,CAAmCF,IAAI,CAACL,IAAxC,CAAnB,CAF4C,CAI5C;;AACA,QAAMQ,OAAO,GAAG;AAAEC,IAAAA,eAAe,EAAE;AAAEC,MAAAA,eAAe,EAAEL,IAAI,CAACM;AAAxB;AAAnB,GAAhB,CAL4C,CAO5C;;AACA,QAAML,UAAU,CAACM,UAAX,CAAsBP,IAAtB,EAA4BG,OAA5B,CAAN;AACD,CATD,C,CAUA;AAEA;;;AACA,MAAMK,gBAAgB,GAAG,MAAOR,IAAP,IAAgB;AACvC,MAAI,CAACA,IAAL,EAAW,OAD4B,CAGvC;;AACA,QAAMD,qBAAqB,CAACC,IAAD,CAA3B;AACD,CALD,C,CAMA;;;AAEA,eAAeQ,gBAAf","sourcesContent":["// ./src/azure-storage-blob.ts\r\n\r\n// <snippet_package>\r\n// THIS IS SAMPLE CODE ONLY - NOT MEANT FOR PRODUCTION USE\r\nimport { BlobServiceClient } from \"@azure/storage-blob\";\r\n\r\nconst containerName = `uploaded`;\r\nconst sasToken = process.env.REACT_APP_AZURE_STORAGE_SAS_TOKEN;\r\nconst storageAccountName = process.env.REACT_APP_AZURE_STORAGE_RESOURCE_NAME;\r\n// </snippet_package>\r\n\r\n// <snippet_get_client>\r\nconst uploadUrl = `https://${storageAccountName}.blob.core.windows.net/?${sasToken}`;\r\nconsole.log(uploadUrl);\r\n\r\n// get BlobService = notice `?` is pulled out of sasToken - if created in Azure portal\r\nconst blobService = new BlobServiceClient(uploadUrl);\r\n\r\n// get Container - full public read access\r\nconst containerClient =\r\n  blobService.getContainerClient(containerName);\r\n// </snippet_get_client>\r\n\r\n// <snippet_isStorageConfigured>\r\n// Feature flag - disable storage feature to app if not configured\r\nexport const isStorageConfigured = () => {\r\n  return !storageAccountName || !sasToken ? false : true;\r\n};\r\n// </snippet_isStorageConfigured>\r\n\r\n// <snippet_getBlobsInContainer>\r\n// return list of blobs in container to display\r\nexport const getBlobsInContainer = async () => {\r\n  const returnedBlobUrls = [];\r\n\r\n  // get list of blobs in container\r\n  // eslint-disable-next-line\r\n  for await (const blob of containerClient.listBlobsFlat()) {\r\n    console.log(`${blob.name}`);\r\n\r\n    const blobItem = {\r\n      url: `https://${storageAccountName}.blob.core.windows.net/${containerName}/${blob.name}?${sasToken}`,\r\n      name: blob.name\r\n    }\r\n\r\n    // if image is public, just construct URL\r\n    returnedBlobUrls.push(blobItem);\r\n  }\r\n\r\n  return returnedBlobUrls;\r\n};\r\n// </snippet_getBlobsInContainer>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n// <snippet_createBlobInContainer>\r\nconst createBlobInContainer = async (file) => {\r\n  // create blobClient for container\r\n  const blobClient = containerClient.getBlockBlobClient(file.name);\r\n\r\n  // set mimetype as determined from browser with file upload control\r\n  const options = { blobHTTPHeaders: { blobContentType: file.type } };\r\n\r\n  // upload file\r\n  await blobClient.uploadData(file, options);\r\n};\r\n// </snippet_createBlobInContainer>\r\n\r\n// <snippet_uploadFileToBlob>\r\nconst uploadFileToBlob = async (file) => {\r\n  if (!file) return;\r\n\r\n  // upload file\r\n  await createBlobInContainer(file);\r\n};\r\n// </snippet_uploadFileToBlob>\r\n\r\nexport default uploadFileToBlob;\r\n\r\n\r\n\r\n\r\n"]},"metadata":{},"sourceType":"module"}